<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: elasticsearch | tka's blog]]></title>
  <link href="http://tka.github.io/blog/categories/elasticsearch/atom.xml" rel="self"/>
  <link href="http://tka.github.io/"/>
  <updated>2014-01-31T17:28:07+08:00</updated>
  <id>http://tka.github.io/</id>
  <author>
    <name><![CDATA[tka]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[elasticsearch入門筆記(1)]]></title>
    <link href="http://tka.github.io/blog/2012/02/25/elasticsearchru-men-bi-ji-1/"/>
    <updated>2012-02-25T16:08:00+08:00</updated>
    <id>http://tka.github.io/blog/2012/02/25/elasticsearchru-men-bi-ji-1</id>
    <content type="html"><![CDATA[<h2>角色關係對照</h2>

<p>elasticsearch 跟 MySQL 中定義資料格式的角色關係對照表如下</p>

<table class="midden center">
  <thead><tr><th>MySQL</th><th>elasticsearch</th></tr></thead>
  <tbody>
    <tr><td>database</td>     <td>index</td></tr>
    <tr><td>table</td>        <td>type</td></tr>
    <tr><td>table schema</td> <td>mapping</td></tr>
    <tr><td>row</td>          <td>document</td></tr>
    <tr><td>field</td>        <td>field</td></tr>
  </tbody>
</table>




<!-- more -->


<h2>設定檔與目錄配置</h2>

<p>參考:</p>

<ul>
<li><a href="http://www.elasticsearch.org/guide/reference/setup/dir-layout.html">http://www.elasticsearch.org/guide/reference/setup/dir-layout.html</a></li>
<li><a href="http://www.elasticsearch.org/guide/reference/setup/configuration.html">http://www.elasticsearch.org/guide/reference/setup/configuration.html</a></li>
</ul>


<h2>建立 index</h2>

<p><code>curl -XPUT 'http://localhost:9200/my_index_name/'</code> 這邊的 <code>my_index_name</code> 就是要被建立的 index 的名字</p>

<h2>設定 index</h2>

<p>```
curl -XPUT &lsquo;localhost:9200/my_index_name/_settings&rsquo; -d &lsquo;
{</p>

<pre><code>"index" : {
    "number_of_replicas" : 4
}
</code></pre>

<p>}
&lsquo;
```<br/>
可以設定的參數在 <a href="http://www.elasticsearch.org/guide/reference/api/admin-indices-update-settings.html">這頁</a></p>

<h2>建立 type 與 mapping</h2>

<p>在預設的情況下 elasticsearch 會自動建立 type 跟 mapping, 但是我會建議自行定義 mapping 的內容, 因為這樣可以做出比較符合需求的設定,例如不同的欄位要使用不同的分詞方式</p>

<p>下面的範例中 <code>my_index_name</code>, <code>my_type_name</code>, <code>my_field_name</code> 都是自己命名的
```
curl -XPUT &lsquo;<a href="http://localhost:9200/my_index_name/my_type_name/_mapping">http://localhost:9200/my_index_name/my_type_name/_mapping</a>&rsquo; -d &lsquo;
{</p>

<pre><code>"my_type_name" : {
    "properties" : {
        "my_field_name" : {"type" : "string", "store" : "yes"},
        "my_field_name2" : {"type" : "string", "store" : "yes"},
        "my_field_name3" : {"type" : "date", "store" : "yes"}
    }
}
</code></pre>

<p>}
&lsquo;
<code>``
每個欄位的定義, 會像是</code>&ldquo;my_field_name&rdquo; : {&ldquo;type&rdquo; : &ldquo;string&rdquo;, &ldquo;store&rdquo; : &ldquo;yes&rdquo;}` 這樣子,
常用的欄位格式定義可以參考<a href="http://www.elasticsearch.org/guide/reference/mapping/core-types.html">這頁</a></p>

<h2>建立搜尋資料</h2>

<p>```
curl -XPOST &lsquo;localhost:9200/my_index_name/my_type_name/1&rsquo; -d &lsquo;
{</p>

<pre><code>"my_field_name" : "test",
"my_field_name2": "test2",
"my_fidle_name3": "2012-02-1"
</code></pre>

<p>}
&lsquo;
```</p>

<p><code>my_index_name/my_type_name/1</code> 中的<code>1</code>代表的是這比資料的<code>id</code>, 建議寫入資料庫裏面的 primaty key, 如果沒有設定的話, 會自動產生像是<code>EYQqF6eyTJGJ-6aZiIYZsg</code>的內容</p>

<h2>搜尋資料</h2>

<p>```
curl -XPOST &lsquo;localhost:9200/my_index_name/my_type_name/_search&rsquo; -d &lsquo;
{</p>

<pre><code>"query":{ 
    "text":{ "_all":"test"}
}
</code></pre>

<p>}
&lsquo;
```</p>

<p>詳細搜尋的語法需參考<a href="http://www.elasticsearch.org/guide/reference/query-dsl/">這頁</a></p>
]]></content>
  </entry>
  
</feed>
